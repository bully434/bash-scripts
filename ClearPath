Легенда
Купила Вера новейший мощнейший ноутбук, поставила на него современную операционную систему BolgenOS. Но, прошло какое-то время и ноутбук начал нещадно тормозить. Даже эксклюзивно вышедшая под линукс Half Life 3, запускаемая из терминала, открывалась долго и неохотно. Помогите Вере обрести веру в мощнейший ноутбук и заодним почистить систему от всего лишнего. Например, многие программы, которые устанавливались и затем удалялись, оставили после себя в PATH то, что пользователю уже никогда и не пригодится.

Постановка задачи
Стандартный уровень сложности (10 баллов)
Написать скрипт на bash, очищающий PATH (или переданный аргумент) от "лишних" директорий. "Лишняя" директория - та, которая либо не существует, либо не содержит исполняемых файлов. Выводить результат в том же формате (директории, разделенные символом ":")

За что может быть снижена оценка?
скрипт не всегда выполняет поставленную задачу (например, иногда дает неверный ответ)
скрипт выводит лишние сообщения в stdout или stderr
скрипт написан небрежно (дублирование кода или плохое форматирование)
скрипт выводит непонятное сообщение об ошибке, если что-то идет не так (пример плохого сообщения: "Error", пример хорошего: "Error: cannot create directory 'foobar'")
скрипт имеет непонятный help либо help не выводится по стандартным для GNU/Linux ключам (-h, --help)
скрипт оставляет после себя временные файлы
скрипт не проверяет код выхода команд, которые могут завершиться неуспешно (например, mkdir или cp или convert ...)
вы используете конструкции, которые мы не проходили на практике, и не можете объяснить, как они работают
вы заимствуете большой кусок чужого кода, в котором не разобрались
 

Примеры запуска

# Выводим справку

$ ./clearPath.sh -h

Usage: ...

 

# Выводим очищенное содержимое PATH

$ ./clearPath.sh

/usr/local/bin:/usr/sbin:/usr/bin:/sbin

 

# Выводим очищенное содержимое переданного аргумента

$ ./clearPath.sh /bin:/usr/bin:/etc:/tmp/nonexistent

/bin:/usr/bin

 

# Не забываем, что на директориях тоже может стоять право +x (что оно означает, кстати?)

$ ./clearPath.sh /bin:/home

/bin

 

 Повышенный уровень сложности (15 баллов)

[A] Избавиться от дублирующихся путей (+2 балла)
[B] Корректно работать, если есть каталоги с пробелами или табуляцией в имени (+1 балл)
[C] Считать относительные пути также "лишними" (+1 балл). Относительный путь - это путь не от корня. На какой каталог он указывает, зависит от текущего каталога.
[D] В коде не должно быть ошибок и предупреждений по мнению shellcheck (+1 балл)
Примечание
shellcheck доступен в двух вариантах

 веб-сервис (http://www.shellcheck.net/)
консольная утилита shellcheck (предварительно установив: sudo apt-get install shellcheck)
